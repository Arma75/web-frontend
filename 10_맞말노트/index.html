<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>ğŸ“– ë§ë§ë…¸íŠ¸</title>

        <!-- Meta Tags -->
        <meta charset="UTF-8"/> <!-- ë¬¸ì ì¸ì½”ë”© ì„¤ì • -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <!-- ë°˜ì‘í˜• ì›¹ ì„¤ì • -->
        <meta name="format-detection" content="telephone=no"/> <!-- ì „í™”ë²ˆí˜¸ ìë™ ê°ì§€ ë¹„í™œì„±í™” -->
        <meta name="robots" content="index, follow"/> <!-- ê²€ìƒ‰ ì—”ì§„ í¬ë¡¤ë§ ì„¤ì • -->
        <meta name="title" content="ğŸ“– ë§ë§ë…¸íŠ¸"/> <!-- ì œëª© ì„¤ì • -->
        <meta name="description" content="ì—°ì• , ì„±ì·¨, ì¼ìƒ ê³ ë¯¼ì— ëŒ€í•œ ë¼ˆ ë•Œë¦¬ëŠ” ë§ë§ì„ ë“œë¦½ë‹ˆë‹¤. íŒ©í­ ë‹¹í•˜ê³  ì •ì‹  ì°¨ë¦¬ê³  ì‹¶ì„ ë•Œ í´ë¦­í•˜ì„¸ìš”."/> <!-- ì„¤ëª… ì„¤ì • -->
        <meta name="keywords" content="ë§ë§ë…¸íŠ¸, íŒ©í­, ê³ ë¯¼í•´ê²°, ì¡°ì–¸, ì—°ì• ê³ ë¯¼, ì¸ìƒì¡°ì–¸, ë‹µì •ë„ˆ, ë¼ˆë•Œë¦¬ëŠ”ë§"/> <!-- í‚¤ì›Œë“œ ì„¤ì • -->
        <meta name="author" content="attickok"/> <!-- ì‘ì„±ì ì„¤ì • -->

        <!-- Open Graph Meta Tags(SNS ê³µìœ ) -->
        <meta property="og:type" content="website" /> <!-- íƒ€ì… ì„¤ì • -->
        <meta property="og:title" content="ğŸ“– ë§ë§ë…¸íŠ¸" /> <!-- ì œëª© ì„¤ì • -->
        <meta property="og:description" content="ì—°ì• , ì„±ì·¨, ì¼ìƒ ê³ ë¯¼ì— ëŒ€í•œ ë¼ˆ ë•Œë¦¬ëŠ” ë§ë§ì„ ë“œë¦½ë‹ˆë‹¤. íŒ©í­ ë‹¹í•˜ê³  ì •ì‹  ì°¨ë¦¬ê³  ì‹¶ì„ ë•Œ í´ë¦­í•˜ì„¸ìš”." /> <!-- ì„¤ëª… ì„¤ì • -->
        <meta property="og:image" content="./assets/images/thumbnail.png" /> <!-- ì´ë¯¸ì§€ ì„¤ì • -->
        <meta property="og:url" content="https://matmal.netlify.app/" /> <!-- URL ì„¤ì • -->

        <!-- Progressive Web App -->
        <link rel="manifest" href="/manifest.json">

        <!-- Favicon Links -->
        <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicons/favicon-16x16.png"> <!-- 16x16 íŒŒë¹„ì½˜ -->
        <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicons/favicon-32x32.png"> <!-- 32x32 íŒŒë¹„ì½˜ -->
        <link rel="icon" type="image/png" sizes="64x64" href="./assets/favicons/favicon-64x64.png"> <!-- 64x64 íŒŒë¹„ì½˜ -->
        <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicons/favicon-180x180.png"> <!-- ì• í”Œ í„°ì¹˜ ì•„ì´ì½˜ -->

        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">

        <!-- CSS Stylesheet -->
        <link rel="stylesheet" href="./styles/main.css">
        <style>
            body {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-between;
                background-color: #1d1e20;
                color: #8a90a1;
                min-height: 100vh;
            }
            main {
                background-color: #222326;
                border: 1px solid #0e0f14;
                padding: 40px;
                border-radius: 24px;
                width: 440px;
                max-width: 100%;
                box-shadow: 0 2px 24px #0e0f14;
                display: flex;
                flex-direction: column;
                gap: 32px;
                align-items: center;
            }
            .main-page {
                display: flex;
                flex-direction: column;
                gap: 32px;
                align-items: center;
            }
            header {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 12px;
            }
            h1 {
                color: white;
                text-shadow: 0 0 12px white;
            }
            p {
                color: #8a90a1;
                text-align: center;
            }

            footer {
                color: #b5baca;
                font-weight: 600;
                padding: 20px;
            }

            nav {
                display: flex;
                flex-direction: column;
                align-items: stretch;
                gap: 24px;
                width: 100%;
            }

            .mode-section {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 12px;
            }
            .mode-buttons {
                display: flex;
                gap: 12px;
            }
            .mode-buttons > label {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .menu-item:nth-child(1) {
                background: #9b4655;
                box-shadow: 0 0 12px #ff7b92;
                border: 1px solid #ff7b92;
            }
            .menu-item:nth-child(2) {
                background: #9b7446;
                box-shadow: 0 0 12px #ffac49;
                border: 1px solid #ffac49;
            }
            .menu-item:nth-child(3) {
                background: #46699b;
                box-shadow: 0 0 12px #5c9ef9;
                border: 1px solid #5c9ef9;
            }

            .book-page {
                flex: 1;
                display: none;
                width: 100%;
                justify-content: center;
            }

            .book {
                flex: 1;
                background: #9b4655;
                box-shadow: 0 0 12px #ff7b92;
                border: 1px solid #ff7b92;
                
                padding: 40px;
                border-radius: 0 24px 24px 0;
                width: 100%;
                max-width: 440px;

                display: flex;
                justify-content: center;
                align-items: center;
                color: white;
                font-size: 2rem;
                font-weight: 600;
                text-align: center;
                position: relative;
            }

            .page {
                font-size: 1.4rem;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
                gap: 20px;
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
                background-color: #fdfdfd;
                border: 1px solid #e8e6e6;
                box-shadow: inset 3px 0px 20px rgba(0,0,0,0.1);
                transition: transform 0.4s ease-in-out;
                padding: 32px;
                border-radius: 0 24px 24px 0;
            }
            .page.flipped {
                transform-origin: left;
                transform: rotateY(-170deg);
            }
            .page.cover {
                /* background-color: black; */
                color: white;
            }

            @media screen and (max-width: 600px) {
                body {
                    padding: 0;
                    min-width: 100vw;
                    min-height: 100vh;
                }
                .main-page {
                    width: 100%;
                    flex: 1;
                    justify-content: space-between;
                }
                .book-page {
                    padding: 20px;
                }
            }
        </style>
    </head>

    <body>
        <section class="main-page">
            <main>
                <header>
                    <h1>ğŸ“– ë§ë§ë…¸íŠ¸</h1>
                    <p>
                        ë³µì¡í•˜ê²Œ ìƒê°í•˜ì§€ ë§ˆì„¸ìš”.<br>
                        ë§ë§ë¡œ ë‹¹ì‹ ì˜ ê³ ë¯¼ì„ í•´ê²°í•´ë“œë¦½ë‹ˆë‹¤.
                    </p>
                </header>

                <nav class="menu-list">
                    <button class="menu-item">
                        <span class="category-name">ğŸ’™ ì—°ì• </span>
                    </button>

                    <button class="menu-item">
                        <span class="category-name">ğŸ’ ì„±ì·¨</span>
                    </button>

                    <button class="menu-item">
                        <span class="category-name">ğŸ˜ ì¼ìƒ</span>
                    </button>
                </nav>

                <section class="mode-section">
                    <p class="mode-title">ì‘ë‹µ ëª¨ë“œ ì„ íƒ</p>
                    <div class="mode-buttons">
                        <label><input type="radio" value="hard" name="type" checked/>íŒ©í­</label>
                        <label><input type="radio" value="soft" name="type"/>ìš°ì­ˆì­ˆ</label>
                    </div>
                </section>
            </main>

            <footer class="footer-note">
                íŒ©í­ì„ ë‹¹í•˜ê³  ì •ì‹ ì„ ì°¨ë ¤ë³´ì„¸ìš”.
            </footer>
        </section>

        <section class="book-page">
            <article id="book" class="book">
            </article>
        </section>

        <audio id="click-sound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3" preload="auto"></audio>
        <audio id="page-flip-sound" src="https://assets.mixkit.co/active_storage/sfx/1101/1101-preview.mp3" preload="auto"></audio>

        <script src="./scripts/constants.js"></script>
        <script>
            // ì˜¤ë””ì˜¤ í”Œë ˆì´
            function playAudio(audioElement) {
                let audio = null;
                if (typeof audioElement === 'string') {
                    audio = document.querySelector(audioElement);
                } else {
                    audio = audioElement;
                }
                audio.playbackRate = 4.0;
                audio.currentTime = 0;
                audio.play();
            }

            // ë²„íŠ¼ê³¼ ì¸í’‹ í•„ë“œì— íš¨ê³¼ìŒ ë“±ë¡
            document.querySelectorAll("button, input").forEach(button => {
                button.addEventListener("click", _ => {
                    playAudio("#click-sound");
                });
            });

            // ë©”ë‰´ ë²„íŠ¼ í´ë¦­
            document.querySelector(".menu-item:nth-child(1)").addEventListener("click", _ => {
                document.querySelector(".main-page").style.display = "none";
                document.querySelector(".book-page").style.display = "flex";

                initBook("love");

                document.querySelector(".page.cover").style.background = "#9b4655";
                document.querySelector(".page.cover").style.boxShadow = "0 0 12px #ff7b92";
                document.querySelector(".page.cover").style.border = "1px solid #ff7b92";
            });
            document.querySelector(".menu-item:nth-child(2)").addEventListener("click", _ => {
                document.querySelector(".main-page").style.display = "none";
                document.querySelector(".book-page").style.display = "flex";

                initBook("archive");

                document.querySelector(".page.cover").style.background = "#9b7446";
                document.querySelector(".page.cover").style.boxShadow = "0 0 12px #ffac49";
                document.querySelector(".page.cover").style.border = "1px solid #ffac49";
            });
            document.querySelector(".menu-item:nth-child(3)").addEventListener("click", _ => {
                document.querySelector(".main-page").style.display = "none";
                document.querySelector(".book-page").style.display = "flex";

                initBook("life");

                document.querySelector(".page.cover").style.background = "#46699b";
                document.querySelector(".page.cover").style.boxShadow = "0 0 12px #5c9ef9";
                document.querySelector(".page.cover").style.border = "1px solid #5c9ef9";
            });


            const book = document.getElementById('book');
            let isAnimating = false;
            let opened = false;
            let adviceList;

            function initBook(menu) {
                book.innerHTML = "";

                let type = document.querySelector("[name='type']:checked").value;
                adviceList = ADVICE_LIST[menu][type];

                [...adviceList].reverse().forEach((text, index) => {
                    const page = document.createElement('div');
                    page.className = 'page';
                    page.style.zIndex = index + 1; // ë‚®ì€ ì¸ë±ìŠ¤ê°€ ì•„ë˜ë¡œ
                    page.innerHTML = `<p>${text}</p>`;
                    book.appendChild(page);
                });

                const cover = document.createElement('div');
                cover.className = 'page cover';
                if (menu === 'love') {
                    cover.innerHTML = `<h1>ğŸ’™ ì—°ì• </h1>`;
                } else if (menu === 'archive') {
                    cover.innerHTML = `<h1>ğŸ’ ì„±ì·¨</h1>`;
                } else {
                    cover.innerHTML = `<h1>ğŸ˜ ì¼ìƒ</h1>`;
                }
                cover.innerHTML += `<p>ì§ˆë¬¸ì„ ìƒê°í•˜ê³ <br>í´ë¦­í•´ì£¼ì„¸ìš”</p>`;
                cover.style.zIndex = 999;
                book.appendChild(cover);
            }

            async function openBook() {
                if (isAnimating) {
                    return;
                }

                isAnimating = true;

                const pages = Array.from(document.querySelectorAll('.page')).reverse();
                pages.forEach((page, index) => {
                    page.classList.remove('flipped');
                    page.style.zIndex = pages.length - index;
                    if (page.classList.contains("cover")) {
                        page.style.zIndex = 999;
                    }
                    page.style.visibility = 'visible';
                });

                const targetCount = Math.floor(Math.random() * (adviceList.length - 2)) + 1;
                const totalSeconds = Math.max(2000, Math.min(8000, targetCount * 400));
                const interval = totalSeconds / targetCount;

                for (let i = 0; i <= targetCount; i++) {
                    playAudio("#page-flip-sound");
                    pages[i].style.transition = `transform ${interval}ms ease-in-out`;
                    pages[i].classList.add('flipped');
                    if (i > 4) {
                        pages[i - 4].style.visibility = 'hidden';
                    }
                    await new Promise(resolve => setTimeout(resolve, interval / 2));
                    pages[i].style.zIndex = i;
                }

                isAnimating = false;
            }

            book.addEventListener('click', _ => {
                if (!isAnimating) {
                    if (!opened) {
                        openBook();
                    } else {
                        document.querySelector(".main-page").style.display = "flex";
                        document.querySelector(".book-page").style.display = "none";
                    }
                    opened = !opened;
                }
            });
        </script>
    </body>
</html>